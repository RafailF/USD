{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.set.difference.v2.js\");\nrequire(\"core-js/modules/es.set.intersection.v2.js\");\nrequire(\"core-js/modules/es.set.is-disjoint-from.v2.js\");\nrequire(\"core-js/modules/es.set.is-subset-of.v2.js\");\nrequire(\"core-js/modules/es.set.is-superset-of.v2.js\");\nrequire(\"core-js/modules/es.set.symmetric-difference.v2.js\");\nrequire(\"core-js/modules/es.set.union.v2.js\");\nrequire(\"core-js/modules/esnext.iterator.constructor.js\");\nrequire(\"core-js/modules/esnext.iterator.filter.js\");\nrequire(\"core-js/modules/web.dom-exception.stack.js\");\nconst vm = require(\"vm\");\nconst webIDLConversions = require(\"webidl-conversions\");\nconst {\n  CSSStyleDeclaration\n} = require(\"cssstyle\");\nconst whatwgURL = require(\"whatwg-url\");\nconst notImplemented = require(\"./not-implemented\");\nconst {\n  installInterfaces\n} = require(\"../living/interfaces\");\nconst {\n  define,\n  mixin\n} = require(\"../utils\");\nconst Element = require(\"../living/generated/Element\");\nconst EventTarget = require(\"../living/generated/EventTarget\");\nconst EventHandlerNonNull = require(\"../living/generated/EventHandlerNonNull\");\nconst IDLFunction = require(\"../living/generated/Function\");\nconst OnBeforeUnloadEventHandlerNonNull = require(\"../living/generated/OnBeforeUnloadEventHandlerNonNull\");\nconst OnErrorEventHandlerNonNull = require(\"../living/generated/OnErrorEventHandlerNonNull\");\nconst {\n  fireAPageTransitionEvent\n} = require(\"../living/helpers/page-transition-event\");\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\nconst DOMException = require(\"../living/generated/DOMException\");\nconst idlUtils = require(\"../living/generated/utils\");\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\nconst BarProp = require(\"../living/generated/BarProp\");\nconst documents = require(\"../living/documents.js\");\nconst External = require(\"../living/generated/External\");\nconst Navigator = require(\"../living/generated/Navigator\");\nconst Performance = require(\"../living/generated/Performance\");\nconst Screen = require(\"../living/generated/Screen\");\nconst Crypto = require(\"../living/generated/Crypto\");\nconst Storage = require(\"../living/generated/Storage\");\nconst Selection = require(\"../living/generated/Selection\");\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\nconst {\n  getCurrentEventHandlerValue\n} = require(\"../living/helpers/create-event-accessor.js\");\nconst {\n  fireAnEvent\n} = require(\"../living/helpers/events\");\nconst SessionHistory = require(\"../living/window/SessionHistory\");\nconst {\n  getDeclarationForElement,\n  getResolvedValue,\n  propertiesWithResolvedValueImplemented,\n  SHADOW_DOM_PSEUDO_REGEXP\n} = require(\"../living/helpers/style-rules.js\");\nconst CustomElementRegistry = require(\"../living/generated/CustomElementRegistry\");\nconst MessageEvent = require(\"../living/generated/MessageEvent\");\nconst jsGlobals = require(\"./js-globals.json\");\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\nconst events = new Set([\n// GlobalEventHandlers\n\"abort\", \"autocomplete\", \"autocompleteerror\", \"blur\", \"cancel\", \"canplay\", \"canplaythrough\", \"change\", \"click\", \"close\", \"contextmenu\", \"cuechange\", \"dblclick\", \"drag\", \"dragend\", \"dragenter\", \"dragleave\", \"dragover\", \"dragstart\", \"drop\", \"durationchange\", \"emptied\", \"ended\", \"focus\", \"input\", \"invalid\", \"keydown\", \"keypress\", \"keyup\", \"load\", \"loadeddata\", \"loadedmetadata\", \"loadstart\", \"mousedown\", \"mouseenter\", \"mouseleave\", \"mousemove\", \"mouseout\", \"mouseover\", \"mouseup\", \"wheel\", \"pause\", \"play\", \"playing\", \"progress\", \"ratechange\", \"reset\", \"resize\", \"scroll\", \"securitypolicyviolation\", \"seeked\", \"seeking\", \"select\", \"sort\", \"stalled\", \"submit\", \"suspend\", \"timeupdate\", \"toggle\", \"volumechange\", \"waiting\",\n// WindowEventHandlers\n\"afterprint\", \"beforeprint\", \"hashchange\", \"languagechange\", \"message\", \"messageerror\", \"offline\", \"online\", \"pagehide\", \"pageshow\", \"popstate\", \"rejectionhandled\", \"storage\", \"unhandledrejection\", \"unload\"\n\n// \"error\" and \"beforeunload\" are added separately\n]);\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(([name]) => name in global);\nexports.createWindow = options => {\n  const makeVMContext = options.runScripts === \"outside-only\" || options.runScripts === \"dangerously\";\n\n  // Bootstrap with an empty object from the Node.js realm. We'll muck with its prototype chain shortly.\n  const window = {};\n\n  // Make window into a global object: either via vm, or just aliasing the Node.js globals.\n  // Also set _globalObject and _globalProxy.\n  //\n  // TODO: don't expose _globalObject and _globalProxy as public properties. While you're there, audit usage sites to\n  // see how necessary they really are.\n  if (makeVMContext) {\n    vm.createContext(window);\n    window._globalObject = window;\n    window._globalProxy = vm.runInContext(\"this\", window);\n\n    // Without this, these globals will only appear to scripts running inside the context using vm.runScript; they will\n    // not appear to scripts running from the outside, including to JSDOM implementation code.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = {\n        ...globalPropDesc,\n        value: vm.runInContext(globalName, window)\n      };\n      Object.defineProperty(window, globalName, propDesc);\n    }\n  } else {\n    window._globalObject = window._globalProxy = window;\n\n    // Without contextifying the window, none of the globals will exist. So, let's at least alias them from the Node.js\n    // context. See https://github.com/jsdom/jsdom/issues/2727 for more background and discussion.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = {\n        ...globalPropDesc,\n        value: global[globalName]\n      };\n      Object.defineProperty(window, globalName, propDesc);\n    }\n  }\n\n  // Create instances of all the web platform interfaces and install them on the window.\n  installInterfaces(window, [\"Window\"]);\n\n  // Now we have an EventTarget contructor so we can work on the prototype chain.\n\n  // eslint-disable-next-line func-name-matching, func-style\n  const WindowConstructor = function Window() {\n    throw new TypeError(\"Illegal constructor\");\n  };\n  Object.setPrototypeOf(WindowConstructor, window.EventTarget);\n  Object.defineProperty(window, \"Window\", {\n    configurable: true,\n    writable: true,\n    value: WindowConstructor\n  });\n\n  // TODO: do an actual WindowProperties object. See https://github.com/jsdom/jsdom/pull/3765 for an attempt.\n  const windowPropertiesObject = Object.create(window.EventTarget.prototype);\n  Object.defineProperties(windowPropertiesObject, {\n    [Symbol.toStringTag]: {\n      value: \"WindowProperties\",\n      configurable: true\n    }\n  });\n  namedPropertiesWindow.initializeWindow(window, window._globalProxy);\n  const windowPrototype = Object.create(windowPropertiesObject);\n  Object.defineProperties(windowPrototype, {\n    constructor: {\n      value: WindowConstructor,\n      writable: true,\n      configurable: true\n    },\n    [Symbol.toStringTag]: {\n      value: \"Window\",\n      configurable: true\n    }\n  });\n  WindowConstructor.prototype = windowPrototype;\n  Object.setPrototypeOf(window, windowPrototype);\n  if (makeVMContext) {\n    Object.setPrototypeOf(window._globalProxy, windowPrototype);\n    Object.setPrototypeOf(window.EventTarget.prototype, window.Object.prototype);\n  }\n\n  // Now that the prototype chain is fully set up, call the superclass setup.\n  EventTarget.setup(window, window);\n  installEventHandlers(window);\n  installOwnProperties(window, options);\n\n  // Not sure why this is necessary... TODO figure it out.\n  Object.defineProperty(idlUtils.implForWrapper(window), idlUtils.wrapperSymbol, {\n    get: () => window._globalProxy\n  });\n\n  // Fire or prepare to fire load and pageshow events.\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n    if (window.document.readyState === \"complete\") {\n      fireAnEvent(\"load\", window, undefined, {}, true);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        fireAnEvent(\"load\", window, undefined, {}, true);\n        if (!window._document) {\n          return; // window might've been closed already\n        }\n        const documentImpl = idlUtils.implForWrapper(window._document);\n        if (!documentImpl._pageShowingFlag) {\n          documentImpl._pageShowingFlag = true;\n          fireAPageTransitionEvent(\"pageshow\", window, false);\n        }\n      });\n    }\n  });\n  return window;\n};\nfunction installEventHandlers(window) {\n  mixin(window, WindowEventHandlersImpl.prototype);\n  mixin(window, GlobalEventHandlersImpl.prototype);\n  window._initGlobalEvents();\n  Object.defineProperty(window, \"onbeforeunload\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(window, \"beforeunload\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnBeforeUnloadEventHandlerNonNull.convert(window, V, {\n          context: \"Failed to set the 'onbeforeunload' property on 'Window': The provided value\"\n        });\n      }\n      window._setEventHandlerFor(\"beforeunload\", V);\n    }\n  });\n  Object.defineProperty(window, \"onerror\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(window, \"error\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnErrorEventHandlerNonNull.convert(window, V, {\n          context: \"Failed to set the 'onerror' property on 'Window': The provided value\"\n        });\n      }\n      window._setEventHandlerFor(\"error\", V);\n    }\n  });\n  for (const event of events) {\n    Object.defineProperty(window, `on${event}`, {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(window, event));\n      },\n      set(V) {\n        if (!idlUtils.isObject(V)) {\n          V = null;\n        } else {\n          V = EventHandlerNonNull.convert(window, V, {\n            context: `Failed to set the 'on${event}' property on 'Window': The provided value`\n          });\n        }\n        window._setEventHandlerFor(event, V);\n      }\n    });\n  }\n}\nfunction installOwnProperties(window, options) {\n  const windowInitialized = performance.now();\n\n  // ### PRIVATE DATA PROPERTIES\n\n  window._resourceLoader = options.resourceLoader;\n\n  // List options explicitly to be clear which are passed through\n  window._document = documents.createWrapper(window, {\n    parsingMode: options.parsingMode,\n    contentType: options.contentType,\n    encoding: options.encoding,\n    cookieJar: options.cookieJar,\n    url: options.url,\n    lastModified: options.lastModified,\n    referrer: options.referrer,\n    parseOptions: options.parseOptions,\n    defaultView: window._globalProxy,\n    global: window,\n    parentOrigin: options.parentOrigin\n  }, {\n    alwaysUseDocumentClass: true\n  });\n  const documentOrigin = idlUtils.implForWrapper(window._document)._origin;\n  window._origin = documentOrigin;\n\n  // https://html.spec.whatwg.org/#session-history\n  window._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(window._document),\n    url: idlUtils.implForWrapper(window._document)._URL,\n    stateObject: null\n  }, window);\n  window._virtualConsole = options.virtualConsole;\n  window._runScripts = options.runScripts;\n\n  // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n  window._parent = window._top = window._globalProxy;\n  window._frameElement = null;\n\n  // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n  window._length = 0;\n\n  // https://dom.spec.whatwg.org/#window-current-event\n  window._currentEvent = undefined;\n  window._pretendToBeVisual = options.pretendToBeVisual;\n  window._storageQuota = options.storageQuota;\n\n  // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n  if (options.commonForOrigin && options.commonForOrigin[documentOrigin]) {\n    window._commonForOrigin = options.commonForOrigin;\n  } else {\n    window._commonForOrigin = {\n      [documentOrigin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [window]\n      }\n    };\n  }\n  window._currentOriginData = window._commonForOrigin[documentOrigin];\n\n  // ### WEB STORAGE\n\n  window._localStorage = Storage.create(window, [], {\n    associatedWindow: window,\n    storageArea: window._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: window._document.documentURI,\n    storageQuota: window._storageQuota\n  });\n  window._sessionStorage = Storage.create(window, [], {\n    associatedWindow: window,\n    storageArea: window._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: window._document.documentURI,\n    storageQuota: window._storageQuota\n  });\n\n  // ### SELECTION\n\n  // https://w3c.github.io/selection-api/#dfn-selection\n  window._selection = Selection.createImpl(window);\n\n  // https://w3c.github.io/selection-api/#dom-window\n  window.getSelection = function () {\n    return window._selection;\n  };\n\n  // ### GETTERS\n\n  const locationbar = BarProp.create(window);\n  const menubar = BarProp.create(window);\n  const personalbar = BarProp.create(window);\n  const scrollbars = BarProp.create(window);\n  const statusbar = BarProp.create(window);\n  const toolbar = BarProp.create(window);\n  const external = External.create(window);\n  const navigator = Navigator.create(window, [], {\n    userAgent: window._resourceLoader._userAgent\n  });\n  const performanceImpl = Performance.create(window, [], {\n    timeOrigin: performance.timeOrigin + windowInitialized,\n    nowAtTimeOrigin: windowInitialized\n  });\n  const screen = Screen.create(window);\n  const crypto = Crypto.create(window);\n  window._customElementRegistry = CustomElementRegistry.create(window);\n  define(window, {\n    get length() {\n      return window._length;\n    },\n    get window() {\n      return window._globalProxy;\n    },\n    get frameElement() {\n      return idlUtils.wrapperForImpl(window._frameElement);\n    },\n    get frames() {\n      return window._globalProxy;\n    },\n    get self() {\n      return window._globalProxy;\n    },\n    get parent() {\n      return window._parent;\n    },\n    get top() {\n      return window._top;\n    },\n    get document() {\n      return window._document;\n    },\n    get external() {\n      return external;\n    },\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n    // [PutForwards=href]:\n    set location(value) {\n      Reflect.set(window.location, \"href\", value);\n    },\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n    get navigator() {\n      return navigator;\n    },\n    get locationbar() {\n      return locationbar;\n    },\n    get menubar() {\n      return menubar;\n    },\n    get personalbar() {\n      return personalbar;\n    },\n    get scrollbars() {\n      return scrollbars;\n    },\n    get statusbar() {\n      return statusbar;\n    },\n    get toolbar() {\n      return toolbar;\n    },\n    get performance() {\n      return performanceImpl;\n    },\n    get screen() {\n      return screen;\n    },\n    get crypto() {\n      return crypto;\n    },\n    get origin() {\n      return window._origin;\n    },\n    get localStorage() {\n      if (idlUtils.implForWrapper(window._document)._origin === \"null\") {\n        throw DOMException.create(window, [\"localStorage is not available for opaque origins\", \"SecurityError\"]);\n      }\n      return window._localStorage;\n    },\n    get sessionStorage() {\n      if (idlUtils.implForWrapper(window._document)._origin === \"null\") {\n        throw DOMException.create(window, [\"sessionStorage is not available for opaque origins\", \"SecurityError\"]);\n      }\n      return window._sessionStorage;\n    },\n    get customElements() {\n      return window._customElementRegistry;\n    },\n    get event() {\n      return window._currentEvent ? idlUtils.wrapperForImpl(window._currentEvent) : undefined;\n    }\n  });\n  Object.defineProperties(window, {\n    // [Replaceable]:\n    self: makeReplaceablePropertyDescriptor(\"self\", window),\n    locationbar: makeReplaceablePropertyDescriptor(\"locationbar\", window),\n    menubar: makeReplaceablePropertyDescriptor(\"menubar\", window),\n    personalbar: makeReplaceablePropertyDescriptor(\"personalbar\", window),\n    scrollbars: makeReplaceablePropertyDescriptor(\"scrollbars\", window),\n    statusbar: makeReplaceablePropertyDescriptor(\"statusbar\", window),\n    toolbar: makeReplaceablePropertyDescriptor(\"toolbar\", window),\n    frames: makeReplaceablePropertyDescriptor(\"frames\", window),\n    parent: makeReplaceablePropertyDescriptor(\"parent\", window),\n    external: makeReplaceablePropertyDescriptor(\"external\", window),\n    length: makeReplaceablePropertyDescriptor(\"length\", window),\n    screen: makeReplaceablePropertyDescriptor(\"screen\", window),\n    origin: makeReplaceablePropertyDescriptor(\"origin\", window),\n    event: makeReplaceablePropertyDescriptor(\"event\", window),\n    // [LegacyUnforgeable]:\n    window: {\n      configurable: false\n    },\n    document: {\n      configurable: false\n    },\n    location: {\n      configurable: false\n    },\n    top: {\n      configurable: false\n    }\n  });\n\n  // ### METHODS\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers\n\n  // In the spec the list of active timers is a set of IDs. We make it a map of IDs to Node.js timer objects, so that\n  // we can call Node.js-side clearTimeout() when clearing, and thus allow process shutdown faster.\n  const listOfActiveTimers = new Map();\n  let latestTimerId = 0;\n  window.setTimeout = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n    return timerInitializationSteps(handler, timeout, args, {\n      methodContext: window,\n      repeat: false\n    });\n  };\n  window.setInterval = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n    return timerInitializationSteps(handler, timeout, args, {\n      methodContext: window,\n      repeat: true\n    });\n  };\n  window.clearTimeout = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  window.clearInterval = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      // We use setTimeout() in timerInitializationSteps even for window.setInterval().\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  function timerInitializationSteps(handler, timeout, args, {\n    methodContext,\n    repeat,\n    previousHandle\n  }) {\n    // This appears to be unspecced, but matches browser behavior for close()ed windows.\n    if (!methodContext._document) {\n      return 0;\n    }\n\n    // TODO: implement timer nesting level behavior.\n\n    const methodContextProxy = methodContext._globalProxy;\n    const handle = previousHandle !== undefined ? previousHandle : ++latestTimerId;\n    function task() {\n      if (!listOfActiveTimers.has(handle)) {\n        return;\n      }\n      try {\n        if (typeof handler === \"function\") {\n          handler.apply(methodContextProxy, args);\n        } else if (window._runScripts === \"dangerously\") {\n          vm.runInContext(handler, window, {\n            filename: window.location.href,\n            displayErrors: false\n          });\n        }\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n      if (listOfActiveTimers.has(handle)) {\n        if (repeat) {\n          timerInitializationSteps(handler, timeout, args, {\n            methodContext,\n            repeat: true,\n            previousHandle: handle\n          });\n        } else {\n          listOfActiveTimers.delete(handle);\n        }\n      }\n    }\n    if (timeout < 0) {\n      timeout = 0;\n    }\n    const nodejsTimer = setTimeout(task, timeout);\n    listOfActiveTimers.set(handle, nodejsTimer);\n    return handle;\n  }\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing\n\n  window.queueMicrotask = function (callback) {\n    callback = IDLFunction.convert(window, callback);\n    queueMicrotask(() => {\n      try {\n        callback();\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n    });\n  };\n\n  // https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frames\n\n  let animationFrameCallbackId = 0;\n  const mapOfAnimationFrameCallbacks = new Map();\n  let animationFrameNodejsInterval = null;\n\n  // Unlike the spec, where an animation frame happens every 60 Hz regardless, we optimize so that if there are no\n  // requestAnimationFrame() calls outstanding, we don't fire the timer. This helps us track that.\n  let numberOfOngoingAnimationFrameCallbacks = 0;\n  if (window._pretendToBeVisual) {\n    window.requestAnimationFrame = function (callback) {\n      callback = IDLFunction.convert(window, callback);\n      const handle = ++animationFrameCallbackId;\n      mapOfAnimationFrameCallbacks.set(handle, callback);\n      ++numberOfOngoingAnimationFrameCallbacks;\n      if (numberOfOngoingAnimationFrameCallbacks === 1) {\n        animationFrameNodejsInterval = setInterval(() => {\n          runAnimationFrameCallbacks(performance.now() - windowInitialized);\n        }, 1000 / 60);\n      }\n      return handle;\n    };\n    window.cancelAnimationFrame = function (handle) {\n      handle = webIDLConversions[\"unsigned long\"](handle);\n      removeAnimationFrameCallback(handle);\n    };\n    function runAnimationFrameCallbacks(now) {\n      // Converting to an array is important to get a sync snapshot and thus match spec semantics.\n      const callbackHandles = [...mapOfAnimationFrameCallbacks.keys()];\n      for (const handle of callbackHandles) {\n        // This has() can be false if a callback calls cancelAnimationFrame().\n        if (mapOfAnimationFrameCallbacks.has(handle)) {\n          const callback = mapOfAnimationFrameCallbacks.get(handle);\n          removeAnimationFrameCallback(handle);\n          try {\n            callback(now);\n          } catch (e) {\n            reportException(window, e, window.location.href);\n          }\n        }\n      }\n    }\n    function removeAnimationFrameCallback(handle) {\n      if (mapOfAnimationFrameCallbacks.has(handle)) {\n        --numberOfOngoingAnimationFrameCallbacks;\n        if (numberOfOngoingAnimationFrameCallbacks === 0) {\n          clearInterval(animationFrameNodejsInterval);\n        }\n      }\n      mapOfAnimationFrameCallbacks.delete(handle);\n    }\n  }\n  function stopAllTimers() {\n    for (const nodejsTimer of listOfActiveTimers.values()) {\n      clearTimeout(nodejsTimer);\n    }\n    listOfActiveTimers.clear();\n    clearInterval(animationFrameNodejsInterval);\n  }\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n    text = webIDLConversions.DOMString(text);\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n    const option = window._document.createElement(\"option\");\n    const impl = idlUtils.implForWrapper(option);\n    if (text !== \"\") {\n      impl.text = text;\n    }\n    if (value !== undefined) {\n      impl.setAttributeNS(null, \"value\", value);\n    }\n    if (defaultSelected) {\n      impl.setAttributeNS(null, \"selected\", \"\");\n    }\n    impl._selectedness = selected;\n    return option;\n  }\n  Object.defineProperty(Option, \"prototype\", {\n    value: window.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  function Image(...args) {\n    const img = window._document.createElement(\"img\");\n    const impl = idlUtils.implForWrapper(img);\n    if (args.length > 0) {\n      impl.setAttributeNS(null, \"width\", String(args[0]));\n    }\n    if (args.length > 1) {\n      impl.setAttributeNS(null, \"height\", String(args[1]));\n    }\n    return img;\n  }\n  Object.defineProperty(Image, \"prototype\", {\n    value: window.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttributeNS(null, \"preload\", \"auto\");\n    if (src !== undefined) {\n      impl.setAttributeNS(null, \"src\", String(src));\n    }\n    return audio;\n  }\n  Object.defineProperty(Audio, \"prototype\", {\n    value: window.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  window.postMessage = function (message, targetOrigin) {\n    if (arguments.length < 2) {\n      throw new TypeError(\"'postMessage' requires 2 arguments: 'message' and 'targetOrigin'\");\n    }\n    targetOrigin = webIDLConversions.DOMString(targetOrigin);\n    if (targetOrigin === \"/\") {\n      // TODO: targetOrigin === \"/\" requires getting incumbent settings object.\n      // Maybe could be done with Error stack traces??\n      return;\n    } else if (targetOrigin !== \"*\") {\n      const parsedURL = whatwgURL.parseURL(targetOrigin);\n      if (parsedURL === null) {\n        throw DOMException.create(window, [\"Failed to execute 'postMessage' on 'Window': \" + \"Invalid target origin '\" + targetOrigin + \"' in a call to 'postMessage'.\", \"SyntaxError\"]);\n      }\n      targetOrigin = whatwgURL.serializeURLOrigin(parsedURL);\n      if (targetOrigin !== idlUtils.implForWrapper(window._document)._origin) {\n        // Not implemented.\n        return;\n      }\n    }\n\n    // TODO: event.source - requires reference to incumbent window\n    // TODO: event.origin - requires reference to incumbent window\n    // TODO: event.ports\n    // TODO: event.data - requires structured cloning\n    setTimeout(() => {\n      fireAnEvent(\"message\", window, MessageEvent, {\n        data: message\n      });\n    }, 0);\n  };\n  window.atob = function (str) {\n    try {\n      return atob(str);\n    } catch {\n      // Convert Node.js DOMException to one from our global.\n      throw DOMException.create(window, [\"The string to be decoded contains invalid characters.\", \"InvalidCharacterError\"]);\n    }\n  };\n  window.btoa = function (str) {\n    try {\n      return btoa(str);\n    } catch {\n      // Convert Node.js DOMException to one from our global.\n      throw DOMException.create(window, [\"The string to be encoded contains invalid characters.\", \"InvalidCharacterError\"]);\n    }\n  };\n  window.stop = function () {\n    const manager = idlUtils.implForWrapper(window._document)._requestManager;\n    if (manager) {\n      manager.close();\n    }\n  };\n  window.close = function () {\n    // Recursively close child frame windows, then ourselves (depth-first).\n    for (let i = 0; i < window.length; ++i) {\n      window[i].close();\n    }\n\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n    idlUtils.implForWrapper(window)._eventListeners = Object.create(null);\n    if (window._document) {\n      if (window._document.body) {\n        window._document.body.innerHTML = \"\";\n      }\n      if (window._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(window._document)._eventListeners = Object.create(null);\n        window._document.close();\n      }\n      const doc = idlUtils.implForWrapper(window._document);\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n      delete window._document;\n    }\n    stopAllTimers();\n    WebSocketImpl.cleanUpWindow(window);\n  };\n  window.getComputedStyle = function (elt, pseudoElt = undefined) {\n    elt = Element.convert(window, elt);\n    if (pseudoElt !== undefined && pseudoElt !== null) {\n      pseudoElt = webIDLConversions.DOMString(pseudoElt);\n    }\n    if (pseudoElt !== undefined && pseudoElt !== null && pseudoElt !== \"\") {\n      // TODO: Parse pseudoElt\n\n      if (SHADOW_DOM_PSEUDO_REGEXP.test(pseudoElt)) {\n        throw new TypeError(\"Tried to get the computed style of a Shadow DOM pseudo-element.\");\n      }\n      notImplemented(\"window.getComputedStyle(elt, pseudoElt)\", window);\n    }\n    const declaration = new CSSStyleDeclaration();\n    const {\n      forEach\n    } = Array.prototype;\n    const elementDeclaration = getDeclarationForElement(elt);\n    forEach.call(elementDeclaration, property => {\n      declaration.setProperty(property, elementDeclaration.getPropertyValue(property), elementDeclaration.getPropertyPriority(property));\n    });\n\n    // https://drafts.csswg.org/cssom/#dom-window-getcomputedstyle\n    const declarations = Object.keys(propertiesWithResolvedValueImplemented);\n    forEach.call(declarations, property => {\n      declaration.setProperty(property, getResolvedValue(elt, property));\n    });\n    return declaration;\n  };\n  window.getSelection = function () {\n    return window._document.getSelection();\n  };\n\n  // The captureEvents() and releaseEvents() methods must do nothing\n  window.captureEvents = function () {};\n  window.releaseEvents = function () {};\n\n  // ### PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n  function wrapConsoleMethod(method) {\n    return (...args) => {\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n  window.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    countReset: wrapConsoleMethod(\"countReset\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    dir: wrapConsoleMethod(\"dir\"),\n    dirxml: wrapConsoleMethod(\"dirxml\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeLog: wrapConsoleMethod(\"timeLog\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n  define(window, {\n    name: \"\",\n    status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenLeft: 0,\n    screenY: 0,\n    screenTop: 0,\n    scrollX: 0,\n    scrollY: 0,\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  });\n}\nfunction makeReplaceablePropertyDescriptor(property, window) {\n  const desc = {\n    set(value) {\n      Object.defineProperty(window, property, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value\n      });\n    }\n  };\n  Object.defineProperty(desc.set, \"name\", {\n    value: `set ${property}`\n  });\n  return desc;\n}","map":{"version":3,"names":["require","vm","webIDLConversions","CSSStyleDeclaration","whatwgURL","notImplemented","installInterfaces","define","mixin","Element","EventTarget","EventHandlerNonNull","IDLFunction","OnBeforeUnloadEventHandlerNonNull","OnErrorEventHandlerNonNull","fireAPageTransitionEvent","namedPropertiesWindow","DOMException","idlUtils","WebSocketImpl","implementation","BarProp","documents","External","Navigator","Performance","Screen","Crypto","Storage","Selection","reportException","getCurrentEventHandlerValue","fireAnEvent","SessionHistory","getDeclarationForElement","getResolvedValue","propertiesWithResolvedValueImplemented","SHADOW_DOM_PSEUDO_REGEXP","CustomElementRegistry","MessageEvent","jsGlobals","GlobalEventHandlersImpl","WindowEventHandlersImpl","events","Set","jsGlobalEntriesToInstall","Object","entries","filter","name","global","exports","createWindow","options","makeVMContext","runScripts","window","createContext","_globalObject","_globalProxy","runInContext","globalName","globalPropDesc","propDesc","value","defineProperty","WindowConstructor","Window","TypeError","setPrototypeOf","configurable","writable","windowPropertiesObject","create","prototype","defineProperties","Symbol","toStringTag","initializeWindow","windowPrototype","constructor","setup","installEventHandlers","installOwnProperties","implForWrapper","wrapperSymbol","get","process","nextTick","document","readyState","undefined","addEventListener","_document","documentImpl","_pageShowingFlag","_initGlobalEvents","enumerable","tryWrapperForImpl","set","V","isObject","convert","context","_setEventHandlerFor","event","windowInitialized","performance","now","_resourceLoader","resourceLoader","createWrapper","parsingMode","contentType","encoding","cookieJar","url","lastModified","referrer","parseOptions","defaultView","parentOrigin","alwaysUseDocumentClass","documentOrigin","_origin","_sessionHistory","_URL","stateObject","_virtualConsole","virtualConsole","_runScripts","_parent","_top","_frameElement","_length","_currentEvent","_pretendToBeVisual","pretendToBeVisual","_storageQuota","storageQuota","commonForOrigin","_commonForOrigin","localStorageArea","Map","sessionStorageArea","windowsInSameOrigin","_currentOriginData","_localStorage","associatedWindow","storageArea","type","documentURI","_sessionStorage","_selection","createImpl","getSelection","locationbar","menubar","personalbar","scrollbars","statusbar","toolbar","external","navigator","userAgent","_userAgent","performanceImpl","timeOrigin","nowAtTimeOrigin","screen","crypto","_customElementRegistry","length","frameElement","wrapperForImpl","frames","self","parent","top","location","_location","Reflect","history","_history","origin","localStorage","sessionStorage","customElements","makeReplaceablePropertyDescriptor","listOfActiveTimers","latestTimerId","setTimeout","handler","timeout","args","DOMString","long","timerInitializationSteps","methodContext","repeat","setInterval","clearTimeout","handle","nodejsTimer","delete","clearInterval","previousHandle","methodContextProxy","task","has","apply","filename","href","displayErrors","e","queueMicrotask","callback","animationFrameCallbackId","mapOfAnimationFrameCallbacks","animationFrameNodejsInterval","numberOfOngoingAnimationFrameCallbacks","requestAnimationFrame","runAnimationFrameCallbacks","cancelAnimationFrame","removeAnimationFrameCallback","callbackHandles","keys","stopAllTimers","values","clear","Option","text","defaultSelected","selected","boolean","option","createElement","impl","setAttributeNS","_selectedness","HTMLOptionElement","Image","img","String","HTMLImageElement","Audio","src","audio","HTMLAudioElement","postMessage","message","targetOrigin","arguments","parsedURL","parseURL","serializeURLOrigin","data","atob","str","btoa","stop","manager","_requestManager","close","i","_eventListeners","body","innerHTML","doc","cleanUpWindow","getComputedStyle","elt","pseudoElt","test","declaration","forEach","Array","elementDeclaration","call","property","setProperty","getPropertyValue","getPropertyPriority","declarations","captureEvents","releaseEvents","wrapConsoleMethod","method","emit","console","assert","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeLog","timeEnd","trace","warn","notImplementedMethod","status","devicePixelRatio","innerWidth","innerHeight","outerWidth","outerHeight","pageXOffset","pageYOffset","screenX","screenLeft","screenY","screenTop","scrollX","scrollY","alert","blur","confirm","focus","moveBy","moveTo","open","print","prompt","resizeBy","resizeTo","scroll","scrollBy","scrollTo","desc"],"sources":["/Users/feyraf/Desktop/projets/Roma/invest/node_modules/jsdom/lib/jsdom/browser/Window.js"],"sourcesContent":["\"use strict\";\nconst vm = require(\"vm\");\nconst webIDLConversions = require(\"webidl-conversions\");\nconst { CSSStyleDeclaration } = require(\"cssstyle\");\nconst whatwgURL = require(\"whatwg-url\");\nconst notImplemented = require(\"./not-implemented\");\nconst { installInterfaces } = require(\"../living/interfaces\");\nconst { define, mixin } = require(\"../utils\");\nconst Element = require(\"../living/generated/Element\");\nconst EventTarget = require(\"../living/generated/EventTarget\");\nconst EventHandlerNonNull = require(\"../living/generated/EventHandlerNonNull\");\nconst IDLFunction = require(\"../living/generated/Function\");\nconst OnBeforeUnloadEventHandlerNonNull = require(\"../living/generated/OnBeforeUnloadEventHandlerNonNull\");\nconst OnErrorEventHandlerNonNull = require(\"../living/generated/OnErrorEventHandlerNonNull\");\nconst { fireAPageTransitionEvent } = require(\"../living/helpers/page-transition-event\");\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\nconst DOMException = require(\"../living/generated/DOMException\");\nconst idlUtils = require(\"../living/generated/utils\");\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\nconst BarProp = require(\"../living/generated/BarProp\");\nconst documents = require(\"../living/documents.js\");\nconst External = require(\"../living/generated/External\");\nconst Navigator = require(\"../living/generated/Navigator\");\nconst Performance = require(\"../living/generated/Performance\");\nconst Screen = require(\"../living/generated/Screen\");\nconst Crypto = require(\"../living/generated/Crypto\");\nconst Storage = require(\"../living/generated/Storage\");\nconst Selection = require(\"../living/generated/Selection\");\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\nconst { getCurrentEventHandlerValue } = require(\"../living/helpers/create-event-accessor.js\");\nconst { fireAnEvent } = require(\"../living/helpers/events\");\nconst SessionHistory = require(\"../living/window/SessionHistory\");\nconst { getDeclarationForElement, getResolvedValue, propertiesWithResolvedValueImplemented,\n  SHADOW_DOM_PSEUDO_REGEXP } = require(\"../living/helpers/style-rules.js\");\nconst CustomElementRegistry = require(\"../living/generated/CustomElementRegistry\");\nconst MessageEvent = require(\"../living/generated/MessageEvent\");\nconst jsGlobals = require(\"./js-globals.json\");\n\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\n\nconst events = new Set([\n  // GlobalEventHandlers\n  \"abort\", \"autocomplete\",\n  \"autocompleteerror\", \"blur\",\n  \"cancel\", \"canplay\", \"canplaythrough\",\n  \"change\", \"click\",\n  \"close\", \"contextmenu\",\n  \"cuechange\", \"dblclick\",\n  \"drag\", \"dragend\",\n  \"dragenter\",\n  \"dragleave\", \"dragover\",\n  \"dragstart\", \"drop\",\n  \"durationchange\", \"emptied\",\n  \"ended\", \"focus\",\n  \"input\", \"invalid\",\n  \"keydown\", \"keypress\",\n  \"keyup\", \"load\", \"loadeddata\",\n  \"loadedmetadata\", \"loadstart\",\n  \"mousedown\", \"mouseenter\",\n  \"mouseleave\", \"mousemove\",\n  \"mouseout\", \"mouseover\",\n  \"mouseup\", \"wheel\",\n  \"pause\", \"play\",\n  \"playing\", \"progress\",\n  \"ratechange\", \"reset\",\n  \"resize\", \"scroll\",\n  \"securitypolicyviolation\",\n  \"seeked\", \"seeking\",\n  \"select\", \"sort\", \"stalled\",\n  \"submit\", \"suspend\",\n  \"timeupdate\", \"toggle\",\n  \"volumechange\", \"waiting\",\n\n  // WindowEventHandlers\n  \"afterprint\",\n  \"beforeprint\",\n  \"hashchange\",\n  \"languagechange\",\n  \"message\",\n  \"messageerror\",\n  \"offline\",\n  \"online\",\n  \"pagehide\",\n  \"pageshow\",\n  \"popstate\",\n  \"rejectionhandled\",\n  \"storage\",\n  \"unhandledrejection\",\n  \"unload\"\n\n  // \"error\" and \"beforeunload\" are added separately\n]);\n\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(([name]) => name in global);\n\nexports.createWindow = options => {\n  const makeVMContext = options.runScripts === \"outside-only\" || options.runScripts === \"dangerously\";\n\n  // Bootstrap with an empty object from the Node.js realm. We'll muck with its prototype chain shortly.\n  const window = {};\n\n  // Make window into a global object: either via vm, or just aliasing the Node.js globals.\n  // Also set _globalObject and _globalProxy.\n  //\n  // TODO: don't expose _globalObject and _globalProxy as public properties. While you're there, audit usage sites to\n  // see how necessary they really are.\n  if (makeVMContext) {\n    vm.createContext(window);\n\n    window._globalObject = window;\n    window._globalProxy = vm.runInContext(\"this\", window);\n\n    // Without this, these globals will only appear to scripts running inside the context using vm.runScript; they will\n    // not appear to scripts running from the outside, including to JSDOM implementation code.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = { ...globalPropDesc, value: vm.runInContext(globalName, window) };\n      Object.defineProperty(window, globalName, propDesc);\n    }\n  } else {\n    window._globalObject = window._globalProxy = window;\n\n    // Without contextifying the window, none of the globals will exist. So, let's at least alias them from the Node.js\n    // context. See https://github.com/jsdom/jsdom/issues/2727 for more background and discussion.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = { ...globalPropDesc, value: global[globalName] };\n      Object.defineProperty(window, globalName, propDesc);\n    }\n  }\n\n  // Create instances of all the web platform interfaces and install them on the window.\n  installInterfaces(window, [\"Window\"]);\n\n  // Now we have an EventTarget contructor so we can work on the prototype chain.\n\n  // eslint-disable-next-line func-name-matching, func-style\n  const WindowConstructor = function Window() {\n    throw new TypeError(\"Illegal constructor\");\n  };\n  Object.setPrototypeOf(WindowConstructor, window.EventTarget);\n\n  Object.defineProperty(window, \"Window\", {\n    configurable: true,\n    writable: true,\n    value: WindowConstructor\n  });\n\n  // TODO: do an actual WindowProperties object. See https://github.com/jsdom/jsdom/pull/3765 for an attempt.\n  const windowPropertiesObject = Object.create(window.EventTarget.prototype);\n  Object.defineProperties(windowPropertiesObject, {\n    [Symbol.toStringTag]: {\n      value: \"WindowProperties\",\n      configurable: true\n    }\n  });\n  namedPropertiesWindow.initializeWindow(window, window._globalProxy);\n\n  const windowPrototype = Object.create(windowPropertiesObject);\n  Object.defineProperties(windowPrototype, {\n    constructor: {\n      value: WindowConstructor,\n      writable: true,\n      configurable: true\n    },\n    [Symbol.toStringTag]: {\n      value: \"Window\",\n      configurable: true\n    }\n  });\n\n  WindowConstructor.prototype = windowPrototype;\n  Object.setPrototypeOf(window, windowPrototype);\n  if (makeVMContext) {\n    Object.setPrototypeOf(window._globalProxy, windowPrototype);\n    Object.setPrototypeOf(window.EventTarget.prototype, window.Object.prototype);\n  }\n\n  // Now that the prototype chain is fully set up, call the superclass setup.\n  EventTarget.setup(window, window);\n\n  installEventHandlers(window);\n\n  installOwnProperties(window, options);\n\n  // Not sure why this is necessary... TODO figure it out.\n  Object.defineProperty(idlUtils.implForWrapper(window), idlUtils.wrapperSymbol, { get: () => window._globalProxy });\n\n  // Fire or prepare to fire load and pageshow events.\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n\n    if (window.document.readyState === \"complete\") {\n      fireAnEvent(\"load\", window, undefined, {}, true);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        fireAnEvent(\"load\", window, undefined, {}, true);\n        if (!window._document) {\n          return; // window might've been closed already\n        }\n\n        const documentImpl = idlUtils.implForWrapper(window._document);\n        if (!documentImpl._pageShowingFlag) {\n          documentImpl._pageShowingFlag = true;\n          fireAPageTransitionEvent(\"pageshow\", window, false);\n        }\n      });\n    }\n  });\n\n  return window;\n};\n\nfunction installEventHandlers(window) {\n  mixin(window, WindowEventHandlersImpl.prototype);\n  mixin(window, GlobalEventHandlersImpl.prototype);\n  window._initGlobalEvents();\n\n  Object.defineProperty(window, \"onbeforeunload\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(window, \"beforeunload\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnBeforeUnloadEventHandlerNonNull.convert(window, V, {\n          context: \"Failed to set the 'onbeforeunload' property on 'Window': The provided value\"\n        });\n      }\n      window._setEventHandlerFor(\"beforeunload\", V);\n    }\n  });\n\n  Object.defineProperty(window, \"onerror\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(window, \"error\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnErrorEventHandlerNonNull.convert(window, V, {\n          context: \"Failed to set the 'onerror' property on 'Window': The provided value\"\n        });\n      }\n      window._setEventHandlerFor(\"error\", V);\n    }\n  });\n\n  for (const event of events) {\n    Object.defineProperty(window, `on${event}`, {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(window, event));\n      },\n      set(V) {\n        if (!idlUtils.isObject(V)) {\n          V = null;\n        } else {\n          V = EventHandlerNonNull.convert(window, V, {\n            context: `Failed to set the 'on${event}' property on 'Window': The provided value`\n          });\n        }\n        window._setEventHandlerFor(event, V);\n      }\n    });\n  }\n}\n\nfunction installOwnProperties(window, options) {\n  const windowInitialized = performance.now();\n\n  // ### PRIVATE DATA PROPERTIES\n\n  window._resourceLoader = options.resourceLoader;\n\n  // List options explicitly to be clear which are passed through\n  window._document = documents.createWrapper(window, {\n    parsingMode: options.parsingMode,\n    contentType: options.contentType,\n    encoding: options.encoding,\n    cookieJar: options.cookieJar,\n    url: options.url,\n    lastModified: options.lastModified,\n    referrer: options.referrer,\n    parseOptions: options.parseOptions,\n    defaultView: window._globalProxy,\n    global: window,\n    parentOrigin: options.parentOrigin\n  }, { alwaysUseDocumentClass: true });\n\n  const documentOrigin = idlUtils.implForWrapper(window._document)._origin;\n  window._origin = documentOrigin;\n\n  // https://html.spec.whatwg.org/#session-history\n  window._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(window._document),\n    url: idlUtils.implForWrapper(window._document)._URL,\n    stateObject: null\n  }, window);\n\n  window._virtualConsole = options.virtualConsole;\n\n  window._runScripts = options.runScripts;\n\n  // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n  window._parent = window._top = window._globalProxy;\n  window._frameElement = null;\n\n  // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n  window._length = 0;\n\n  // https://dom.spec.whatwg.org/#window-current-event\n  window._currentEvent = undefined;\n\n  window._pretendToBeVisual = options.pretendToBeVisual;\n  window._storageQuota = options.storageQuota;\n\n  // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n  if (options.commonForOrigin && options.commonForOrigin[documentOrigin]) {\n    window._commonForOrigin = options.commonForOrigin;\n  } else {\n    window._commonForOrigin = {\n      [documentOrigin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [window]\n      }\n    };\n  }\n\n  window._currentOriginData = window._commonForOrigin[documentOrigin];\n\n  // ### WEB STORAGE\n\n  window._localStorage = Storage.create(window, [], {\n    associatedWindow: window,\n    storageArea: window._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: window._document.documentURI,\n    storageQuota: window._storageQuota\n  });\n  window._sessionStorage = Storage.create(window, [], {\n    associatedWindow: window,\n    storageArea: window._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: window._document.documentURI,\n    storageQuota: window._storageQuota\n  });\n\n  // ### SELECTION\n\n  // https://w3c.github.io/selection-api/#dfn-selection\n  window._selection = Selection.createImpl(window);\n\n  // https://w3c.github.io/selection-api/#dom-window\n  window.getSelection = function () {\n    return window._selection;\n  };\n\n  // ### GETTERS\n\n  const locationbar = BarProp.create(window);\n  const menubar = BarProp.create(window);\n  const personalbar = BarProp.create(window);\n  const scrollbars = BarProp.create(window);\n  const statusbar = BarProp.create(window);\n  const toolbar = BarProp.create(window);\n  const external = External.create(window);\n  const navigator = Navigator.create(window, [], { userAgent: window._resourceLoader._userAgent });\n  const performanceImpl = Performance.create(window, [], {\n    timeOrigin: performance.timeOrigin + windowInitialized,\n    nowAtTimeOrigin: windowInitialized\n  });\n  const screen = Screen.create(window);\n  const crypto = Crypto.create(window);\n  window._customElementRegistry = CustomElementRegistry.create(window);\n\n  define(window, {\n    get length() {\n      return window._length;\n    },\n    get window() {\n      return window._globalProxy;\n    },\n    get frameElement() {\n      return idlUtils.wrapperForImpl(window._frameElement);\n    },\n    get frames() {\n      return window._globalProxy;\n    },\n    get self() {\n      return window._globalProxy;\n    },\n    get parent() {\n      return window._parent;\n    },\n    get top() {\n      return window._top;\n    },\n    get document() {\n      return window._document;\n    },\n    get external() {\n      return external;\n    },\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n    // [PutForwards=href]:\n    set location(value) {\n      Reflect.set(window.location, \"href\", value);\n    },\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n    get navigator() {\n      return navigator;\n    },\n    get locationbar() {\n      return locationbar;\n    },\n    get menubar() {\n      return menubar;\n    },\n    get personalbar() {\n      return personalbar;\n    },\n    get scrollbars() {\n      return scrollbars;\n    },\n    get statusbar() {\n      return statusbar;\n    },\n    get toolbar() {\n      return toolbar;\n    },\n    get performance() {\n      return performanceImpl;\n    },\n    get screen() {\n      return screen;\n    },\n    get crypto() {\n      return crypto;\n    },\n    get origin() {\n      return window._origin;\n    },\n    get localStorage() {\n      if (idlUtils.implForWrapper(window._document)._origin === \"null\") {\n        throw DOMException.create(window, [\n          \"localStorage is not available for opaque origins\",\n          \"SecurityError\"\n        ]);\n      }\n\n      return window._localStorage;\n    },\n    get sessionStorage() {\n      if (idlUtils.implForWrapper(window._document)._origin === \"null\") {\n        throw DOMException.create(window, [\n          \"sessionStorage is not available for opaque origins\",\n          \"SecurityError\"\n        ]);\n      }\n\n      return window._sessionStorage;\n    },\n    get customElements() {\n      return window._customElementRegistry;\n    },\n    get event() {\n      return window._currentEvent ? idlUtils.wrapperForImpl(window._currentEvent) : undefined;\n    }\n  });\n\n  Object.defineProperties(window, {\n    // [Replaceable]:\n    self: makeReplaceablePropertyDescriptor(\"self\", window),\n    locationbar: makeReplaceablePropertyDescriptor(\"locationbar\", window),\n    menubar: makeReplaceablePropertyDescriptor(\"menubar\", window),\n    personalbar: makeReplaceablePropertyDescriptor(\"personalbar\", window),\n    scrollbars: makeReplaceablePropertyDescriptor(\"scrollbars\", window),\n    statusbar: makeReplaceablePropertyDescriptor(\"statusbar\", window),\n    toolbar: makeReplaceablePropertyDescriptor(\"toolbar\", window),\n    frames: makeReplaceablePropertyDescriptor(\"frames\", window),\n    parent: makeReplaceablePropertyDescriptor(\"parent\", window),\n    external: makeReplaceablePropertyDescriptor(\"external\", window),\n    length: makeReplaceablePropertyDescriptor(\"length\", window),\n    screen: makeReplaceablePropertyDescriptor(\"screen\", window),\n    origin: makeReplaceablePropertyDescriptor(\"origin\", window),\n    event: makeReplaceablePropertyDescriptor(\"event\", window),\n\n    // [LegacyUnforgeable]:\n    window: { configurable: false },\n    document: { configurable: false },\n    location: { configurable: false },\n    top: { configurable: false }\n  });\n\n\n  // ### METHODS\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers\n\n  // In the spec the list of active timers is a set of IDs. We make it a map of IDs to Node.js timer objects, so that\n  // we can call Node.js-side clearTimeout() when clearing, and thus allow process shutdown faster.\n  const listOfActiveTimers = new Map();\n  let latestTimerId = 0;\n\n  window.setTimeout = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n\n    return timerInitializationSteps(handler, timeout, args, { methodContext: window, repeat: false });\n  };\n  window.setInterval = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n\n    return timerInitializationSteps(handler, timeout, args, { methodContext: window, repeat: true });\n  };\n\n  window.clearTimeout = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  window.clearInterval = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      // We use setTimeout() in timerInitializationSteps even for window.setInterval().\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n\n  function timerInitializationSteps(handler, timeout, args, { methodContext, repeat, previousHandle }) {\n    // This appears to be unspecced, but matches browser behavior for close()ed windows.\n    if (!methodContext._document) {\n      return 0;\n    }\n\n    // TODO: implement timer nesting level behavior.\n\n    const methodContextProxy = methodContext._globalProxy;\n    const handle = previousHandle !== undefined ? previousHandle : ++latestTimerId;\n\n    function task() {\n      if (!listOfActiveTimers.has(handle)) {\n        return;\n      }\n\n      try {\n        if (typeof handler === \"function\") {\n          handler.apply(methodContextProxy, args);\n        } else if (window._runScripts === \"dangerously\") {\n          vm.runInContext(handler, window, { filename: window.location.href, displayErrors: false });\n        }\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n\n      if (listOfActiveTimers.has(handle)) {\n        if (repeat) {\n          timerInitializationSteps(handler, timeout, args, { methodContext, repeat: true, previousHandle: handle });\n        } else {\n          listOfActiveTimers.delete(handle);\n        }\n      }\n    }\n\n    if (timeout < 0) {\n      timeout = 0;\n    }\n\n    const nodejsTimer = setTimeout(task, timeout);\n    listOfActiveTimers.set(handle, nodejsTimer);\n\n    return handle;\n  }\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing\n\n  window.queueMicrotask = function (callback) {\n    callback = IDLFunction.convert(window, callback);\n\n    queueMicrotask(() => {\n      try {\n        callback();\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n    });\n  };\n\n  // https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frames\n\n  let animationFrameCallbackId = 0;\n  const mapOfAnimationFrameCallbacks = new Map();\n  let animationFrameNodejsInterval = null;\n\n  // Unlike the spec, where an animation frame happens every 60 Hz regardless, we optimize so that if there are no\n  // requestAnimationFrame() calls outstanding, we don't fire the timer. This helps us track that.\n  let numberOfOngoingAnimationFrameCallbacks = 0;\n\n  if (window._pretendToBeVisual) {\n    window.requestAnimationFrame = function (callback) {\n      callback = IDLFunction.convert(window, callback);\n\n      const handle = ++animationFrameCallbackId;\n      mapOfAnimationFrameCallbacks.set(handle, callback);\n\n      ++numberOfOngoingAnimationFrameCallbacks;\n      if (numberOfOngoingAnimationFrameCallbacks === 1) {\n        animationFrameNodejsInterval = setInterval(() => {\n          runAnimationFrameCallbacks(performance.now() - windowInitialized);\n        }, 1000 / 60);\n      }\n\n      return handle;\n    };\n\n    window.cancelAnimationFrame = function (handle) {\n      handle = webIDLConversions[\"unsigned long\"](handle);\n\n      removeAnimationFrameCallback(handle);\n    };\n\n    function runAnimationFrameCallbacks(now) {\n      // Converting to an array is important to get a sync snapshot and thus match spec semantics.\n      const callbackHandles = [...mapOfAnimationFrameCallbacks.keys()];\n      for (const handle of callbackHandles) {\n        // This has() can be false if a callback calls cancelAnimationFrame().\n        if (mapOfAnimationFrameCallbacks.has(handle)) {\n          const callback = mapOfAnimationFrameCallbacks.get(handle);\n          removeAnimationFrameCallback(handle);\n          try {\n            callback(now);\n          } catch (e) {\n            reportException(window, e, window.location.href);\n          }\n        }\n      }\n    }\n\n    function removeAnimationFrameCallback(handle) {\n      if (mapOfAnimationFrameCallbacks.has(handle)) {\n        --numberOfOngoingAnimationFrameCallbacks;\n        if (numberOfOngoingAnimationFrameCallbacks === 0) {\n          clearInterval(animationFrameNodejsInterval);\n        }\n      }\n\n      mapOfAnimationFrameCallbacks.delete(handle);\n    }\n  }\n\n  function stopAllTimers() {\n    for (const nodejsTimer of listOfActiveTimers.values()) {\n      clearTimeout(nodejsTimer);\n    }\n    listOfActiveTimers.clear();\n\n    clearInterval(animationFrameNodejsInterval);\n  }\n\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n    text = webIDLConversions.DOMString(text);\n\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n\n    const option = window._document.createElement(\"option\");\n    const impl = idlUtils.implForWrapper(option);\n\n    if (text !== \"\") {\n      impl.text = text;\n    }\n    if (value !== undefined) {\n      impl.setAttributeNS(null, \"value\", value);\n    }\n    if (defaultSelected) {\n      impl.setAttributeNS(null, \"selected\", \"\");\n    }\n    impl._selectedness = selected;\n\n    return option;\n  }\n  Object.defineProperty(Option, \"prototype\", {\n    value: window.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Image(...args) {\n    const img = window._document.createElement(\"img\");\n    const impl = idlUtils.implForWrapper(img);\n\n    if (args.length > 0) {\n      impl.setAttributeNS(null, \"width\", String(args[0]));\n    }\n    if (args.length > 1) {\n      impl.setAttributeNS(null, \"height\", String(args[1]));\n    }\n\n    return img;\n  }\n  Object.defineProperty(Image, \"prototype\", {\n    value: window.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttributeNS(null, \"preload\", \"auto\");\n\n    if (src !== undefined) {\n      impl.setAttributeNS(null, \"src\", String(src));\n    }\n\n    return audio;\n  }\n  Object.defineProperty(Audio, \"prototype\", {\n    value: window.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  window.postMessage = function (message, targetOrigin) {\n    if (arguments.length < 2) {\n      throw new TypeError(\"'postMessage' requires 2 arguments: 'message' and 'targetOrigin'\");\n    }\n\n    targetOrigin = webIDLConversions.DOMString(targetOrigin);\n\n    if (targetOrigin === \"/\") {\n      // TODO: targetOrigin === \"/\" requires getting incumbent settings object.\n      // Maybe could be done with Error stack traces??\n      return;\n    } else if (targetOrigin !== \"*\") {\n      const parsedURL = whatwgURL.parseURL(targetOrigin);\n      if (parsedURL === null) {\n        throw DOMException.create(window, [\n          \"Failed to execute 'postMessage' on 'Window': \" +\n          \"Invalid target origin '\" + targetOrigin + \"' in a call to 'postMessage'.\",\n          \"SyntaxError\"\n        ]);\n      }\n      targetOrigin = whatwgURL.serializeURLOrigin(parsedURL);\n\n      if (targetOrigin !== idlUtils.implForWrapper(window._document)._origin) {\n        // Not implemented.\n        return;\n      }\n    }\n\n    // TODO: event.source - requires reference to incumbent window\n    // TODO: event.origin - requires reference to incumbent window\n    // TODO: event.ports\n    // TODO: event.data - requires structured cloning\n    setTimeout(() => {\n      fireAnEvent(\"message\", window, MessageEvent, { data: message });\n    }, 0);\n  };\n\n  window.atob = function (str) {\n    try {\n      return atob(str);\n    } catch {\n      // Convert Node.js DOMException to one from our global.\n      throw DOMException.create(window, [\n        \"The string to be decoded contains invalid characters.\",\n        \"InvalidCharacterError\"\n      ]);\n    }\n  };\n\n  window.btoa = function (str) {\n    try {\n      return btoa(str);\n    } catch {\n      // Convert Node.js DOMException to one from our global.\n      throw DOMException.create(window, [\n        \"The string to be encoded contains invalid characters.\",\n        \"InvalidCharacterError\"\n      ]);\n    }\n  };\n\n  window.stop = function () {\n    const manager = idlUtils.implForWrapper(window._document)._requestManager;\n    if (manager) {\n      manager.close();\n    }\n  };\n\n  window.close = function () {\n    // Recursively close child frame windows, then ourselves (depth-first).\n    for (let i = 0; i < window.length; ++i) {\n      window[i].close();\n    }\n\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n    idlUtils.implForWrapper(window)._eventListeners = Object.create(null);\n\n    if (window._document) {\n      if (window._document.body) {\n        window._document.body.innerHTML = \"\";\n      }\n\n      if (window._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(window._document)._eventListeners = Object.create(null);\n        window._document.close();\n      }\n      const doc = idlUtils.implForWrapper(window._document);\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n      delete window._document;\n    }\n\n    stopAllTimers();\n    WebSocketImpl.cleanUpWindow(window);\n  };\n\n  window.getComputedStyle = function (elt, pseudoElt = undefined) {\n    elt = Element.convert(window, elt);\n    if (pseudoElt !== undefined && pseudoElt !== null) {\n      pseudoElt = webIDLConversions.DOMString(pseudoElt);\n    }\n\n    if (pseudoElt !== undefined && pseudoElt !== null && pseudoElt !== \"\") {\n      // TODO: Parse pseudoElt\n\n      if (SHADOW_DOM_PSEUDO_REGEXP.test(pseudoElt)) {\n        throw new TypeError(\"Tried to get the computed style of a Shadow DOM pseudo-element.\");\n      }\n\n      notImplemented(\"window.getComputedStyle(elt, pseudoElt)\", window);\n    }\n\n    const declaration = new CSSStyleDeclaration();\n    const { forEach } = Array.prototype;\n\n    const elementDeclaration = getDeclarationForElement(elt);\n    forEach.call(elementDeclaration, property => {\n      declaration.setProperty(\n        property,\n        elementDeclaration.getPropertyValue(property),\n        elementDeclaration.getPropertyPriority(property)\n      );\n    });\n\n    // https://drafts.csswg.org/cssom/#dom-window-getcomputedstyle\n    const declarations = Object.keys(propertiesWithResolvedValueImplemented);\n    forEach.call(declarations, property => {\n      declaration.setProperty(property, getResolvedValue(elt, property));\n    });\n\n    return declaration;\n  };\n\n  window.getSelection = function () {\n    return window._document.getSelection();\n  };\n\n  // The captureEvents() and releaseEvents() methods must do nothing\n  window.captureEvents = function () {};\n\n  window.releaseEvents = function () {};\n\n  // ### PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n  function wrapConsoleMethod(method) {\n    return (...args) => {\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n\n  window.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    countReset: wrapConsoleMethod(\"countReset\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    dir: wrapConsoleMethod(\"dir\"),\n    dirxml: wrapConsoleMethod(\"dirxml\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeLog: wrapConsoleMethod(\"timeLog\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n\n  define(window, {\n    name: \"\",\n    status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenLeft: 0,\n    screenY: 0,\n    screenTop: 0,\n    scrollX: 0,\n    scrollY: 0,\n\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  });\n}\n\nfunction makeReplaceablePropertyDescriptor(property, window) {\n  const desc = {\n    set(value) {\n      Object.defineProperty(window, property, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value\n      });\n    }\n  };\n\n  Object.defineProperty(desc.set, \"name\", { value: `set ${property}` });\n  return desc;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}